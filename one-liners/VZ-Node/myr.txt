myr(){ qnt=10; [[ $1 ]] && qnt=$1;grep -P "(VmSwap|envID|Name)" /proc/*/status 2>/dev/null | tr "\n" " "| sed 's/Name:/\nName:/g'| grep mysqld | sort -nk6 | tail -n 100 | awk -F'[ \t/]+' '$2>10&&$10>30000{print $6}' |tail -n$qnt |while read ct; do echo "Rolling MySql on $ct"; vzctl exec $ct "(echo; echo $ct; service mysql restart 2>&1) || (echo; echo $ct; service mysqld restart 2>&1)" | sort& done; };myr 
 b2h(){ echo $1 | awk 'function human(x){x[1]/=1024; if (x[1]>=1000){ x[2]++; human(x);}}{a[1]=$1; a[2]=0; human(a); print a[1]""substr("kMGTEPYZ",a[2]+1,1)}'| sed 's/\.\([0-9]\{2\}\)[0-9]*/\.\1/';};  while true; do echo "----------" ; ps -eo pid,user,vsz,comm= | sort -nk2 | awk '{usrs[$2" "$4]+=$3}END{for(usr in usrs){print usrs[usr],usr}}' | sort -n| tail -n 10 | while read bytes rest; do echo "$(b2h $bytes) $rest"; done | column -t; sleep 5; done


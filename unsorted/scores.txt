scores=$RANDOM;lynx --dump --width=1000 http://localhost/whm-server-status?notable > /tmp/${scores};echo;sed -n '/Current Time/,/requests currently being processed/p' /tmp/${scores};echo -e "\n\nActive requests:\n $(egrep '\[Write|Read\]' /tmp/${scores}|cut -d\{ -f2|sed -e 's/\}//g'|awk '{print$NF,$1,$2}'|sort|uniq -c|sort -rnk1|head)\n\nRecent activity:\n$(egrep '\[Write|\[Ready?\]|\[Keepalive\]|\[Closing\]|\[Dead\]' /tmp/${scores}|cut -d\{ -f2|sed -e 's/\}//g'|awk '{print$NF,$1,$2}'|sort|uniq -c|sort -rnk1|head)\n\nKeepalive:\n $(egrep '\[Keepalive\]' /tmp/${scores}|cut -d\{ -f2|sed -e 's/\}//g'|awk '{print$NF,$1,$2}'|sort|uniq -c|sort -rnk1|head)\n";grep -A1000 'FastCGI processes' /tmp/${scores}|grep -v '___'|while read i;do if [[ "$i" =~ Total ]];then echo -e "$i\nUser Pid Active Idle Accesses State\n" >> /tmp/${scores}.fcgi;fi;if [[ "$i" =~ [0-9]+{1,5} || "$i" =~ Pid ]];then echo $i;fi;done|sed -e 's/^Process:.*/\n/'|while IFS=' ' read pid stuff;do if [[ "$pid" =~ ^[0-9]+{1,5}$ ]];then uid=$(stat -c "%u" /proc/${pid} 2>&1);if [[ "$uid" =~ ^[0-9]+$ ]];then user=$(awk -F':' '/x:'"${uid}"':/ {print$1}' /etc/passwd);echo "${user} ${pid} ${stuff}" >> /tmp/${scores}.fcgi;fi;fi;done && [[ -f /tmp/${scores}.fcgi ]] && column -t /tmp/${scores}.fcgi;[[ -f /tmp/${scores} ]] && rm -f /tmp/${scores};[[ -f /tmp/${scores}.fcgi ]] && rm -f /tmp/${scores}.fcgi